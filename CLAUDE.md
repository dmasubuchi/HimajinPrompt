# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview
This is a Google Apps Script (GAS) project for automatically generating Google Slides presentations from JSON data. The system specializes in creating business presentations with diverse visual patterns and BPMN swimlane diagrams.

## Core Architecture

### Main Components
1. **Prompt System** (まじん式プロンプト v3.md): Advanced AI prompt that converts unstructured text into structured JSON for slide generation. Supports 20+ slide patterns including timeline, process, comparison, pyramid, and specialized business visualizations.

2. **GAS Code** (コード.gs): Google Apps Script that renders JSON data into Google Slides with sophisticated layout patterns and visual elements.

3. **BPMN Extension** (instruct.md): Requirements for generating BPMN swimlane diagrams in both horizontal and vertical orientations.

## Key Technical Details

### Slide Pattern Types
The system supports extensive pattern types defined in the prompt:
- Basic: title, section, closing, content
- Specialized: agenda, timeline, process, processList, compare, statsCompare, barCompare
- Visual: triangle, pyramid, flowChart, stepUp, diagram, cycle
- Business: kpi, progress, faq, quote, imageText
- Data: table, cards, headerCards, bulletCards

### JSON Structure
Each slide follows this schema:
```json
{
  "type": "pattern_type",
  "title": "Slide Title",
  "subhead": "Optional subtitle",
  "notes": "Speaker notes",
  // Pattern-specific properties
}
```

### Text Formatting
- Bold: `**text**`
- Highlighted: `[[important]]` (bold + primary color, restricted to body content)
- Character limits strictly enforced per pattern type
- No bullet points or arrows in text (auto-generated by renderer)

## Development Commands
Since this is a Google Apps Script project deployed as a web app, there are no local build/test commands. The code runs in Google's cloud environment.

### Deployment Configuration (まじん式プロンプトv3 (1).txt)
- Time Zone: Asia/Tokyo
- Runtime: V8
- OAuth Scopes: Presentations, Drive, Script UI
- Access: Public web app

## Important Constraints
1. **Slide Generation Limits**: Maximum 50 slides per presentation
2. **Execution Time**: ~6 minutes Google Apps Script limit
3. **Image Requirements**: <50MB, <25MP, PNG/JPEG/GIF/WebP only
4. **Text Safety**: No prohibited symbols (■, →), no line-starting punctuation
5. **Pattern Selection**: Must use diverse patterns, avoid >30% generic content type

## Working with the Prompt System
The prompt (まじん式プロンプト v3.md) follows a strict 7-step workflow:
1. Context decomposition and normalization
2. Presentation settings confirmation
3. Pattern selection and story reconstruction
4. Slide type mapping
5. Object generation with validation
6. Self-verification and iteration
7. Final JSON output

When modifying the prompt, maintain compatibility with the existing JSON schema and rendering code.