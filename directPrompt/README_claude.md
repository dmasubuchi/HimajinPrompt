# 📋 directPrompt - 直接GASコード生成方式

## 🎯 概要

まじん式プロンプトの**オリジナル方式**を参考に、プロンプトから直接GASコードを生成する仕組みです。

## 📁 ファイル構成

### ⭐ BPMN版（ひまじん式）
- **`BPMN_GEMINI_PROMPT_claude.md`** - 🆕 Gemini最適化版プロンプト
  - トークン効率重視
  - エラー処理強化
  - 簡潔な指示形式

- **`BPMN_SYSTEM_PROMPT_claude.md`** - 汎用版プロンプト（ChatGPT/Claude向け）
  - 詳細な指示
  - 包括的なスキーマ定義
  - 丁寧な説明

### 📚 参考資料（まじん式オリジナル）
- **`system prompt (5).md`** - まじん式プロンプトV2のシステムプロンプト
- **`【V2】_改良版_まじん式プロンプト！｜まじん.html`** - note記事のバックアップ

## 🚀 使い方

### 1. AIを選択

| AI | 推奨プロンプト | 特徴 |
|---|---|---|
| **Gemini** | `BPMN_GEMINI_PROMPT_claude.md` | 高速・効率的 |
| **ChatGPT** | `BPMN_SYSTEM_PROMPT_claude.md` | 詳細・安定 |
| **Claude** | `BPMN_SYSTEM_PROMPT_claude.md` | 高精度 |

### 2. システムプロンプトをコピー
選択したプロンプトファイルの内容を全てコピーして、AIに貼り付ける

### 3. 業務フローを説明
```
例：
「受注処理フローを作って。
営業部が受注を受けて、経理部が請求書を発行し、倉庫が出荷する。」
```

### 4. 生成されたGASコードをコピー
AIが出力した完全なGASコードをコピー

### 5. GASで実行
```
1. Google Apps Scriptを新規作成
2. コードを貼り付け
3. createBPMNPresentation()を実行
4. 生成されたスライドURLを開く
```

## 🎨 特徴

### まじん式の利点を継承
- **プロンプトのみで完結** - 事前準備不要
- **即座に実行可能** - 完全なGASコードを生成
- **カスタマイズ容易** - データ構造が明確

### BPMN特化の改良
- **スイムレーン自動配置** - アクターを部門として認識
- **タスクフロー構築** - 時系列・因果関係を解析
- **ゲートウェイ対応** - 分岐・並列処理を表現

## 📊 生成されるBPMN図の要素

- **スイムレーン**: 部門・担当者を表現
- **タスク**: 業務活動を矩形で表示
- **ゲートウェイ**: 分岐をダイヤモンドで表示
- **フロー**: 矢印で接続関係を表現
- **イベント**: 開始・終了を円で表示（オプション）

## 📚 詳細な使用例

### 例1: シンプルな直列フロー
**入力:**
```
見積作成フローを作って。
営業が見積依頼を受けて、技術部が見積作成、営業部長が承認、営業が顧客に送付
```

**AIの処理:**
- アクター抽出: 営業、技術部、営業部長
- タスク識別: 見積依頼受付、見積作成、承認、顧客送付
- フロー構築: T1→T2→T3→T4の直列フロー

### 例2: 承認分岐を含むフロー
**入力:**
```
経費精算フロー。
社員が申請書作成、上司が確認して、1万円以下なら承認して経理が処理。
1万円超なら部長承認が必要で、その後経理が処理。
```

**AIの処理:**
- ゲートウェイ追加: 金額判定の分岐点
- 条件フロー: 1万円以下/1万円超の2ルート
- 合流処理: 最終的に経理処理に集約

### 例3: 並列処理フロー
**入力:**
```
新入社員オンボーディング。
人事が入社手続き開始。
並行して、総務がPC準備、人事が社内研修実施、情報システムがアカウント作成。
全部完了したら人事が配属先に連絡。
```

**AIの処理:**
- 並列ゲートウェイ: ANDスプリット
- 同時実行タスク: 3つの並列タスク
- 同期ゲートウェイ: ANDジョイン

### 例4: エラー処理を含むフロー
**入力:**
```
在庫確認フロー。
営業が在庫確認依頼、倉庫が在庫チェック。
在庫ありなら出荷準備、在庫なしなら購買部に発注依頼してから営業に連絡。
```

**AIの処理:**
- 条件分岐: 在庫有無の判定
- 例外フロー: 在庫なし時の別ルート
- 通知タスク: 結果の連絡

### 例5: 複雑な承認階層
**入力:**
```
稟議フロー。
起案者が稟議書作成。
10万円未満：課長承認のみ
10万円以上100万円未満：課長→部長承認
100万円以上：課長→部長→役員承認
最後に経理部が処理して起案者に通知。
```

**AIの処理:**
- 多段階ゲートウェイ: 金額による3分岐
- 階層的承認: レベル別承認ルート
- 最終合流: 全ルートが経理処理に集約

## 💡 入力のコツ

### ✅ 良い入力例
```
受注処理フロー。
1. 営業が受注入力
2. 与信部が与信チェック
3. OKなら倉庫が出荷準備、NGなら営業に差し戻し
4. 出荷完了後、経理が請求書発行
```
**ポイント**: アクター明確、順序明確、条件明確

### ❌ 避けるべき入力例
```
注文を処理する
```
**問題**: アクター不明、詳細不足、フロー不明

## 🎯 生成されるGASコードの構造

1. **bpmnData定義**（AIが自動生成）
   - processInfo: プロセス名
   - actors: 部門・担当者リスト
   - tasks: タスクと担当者マッピング
   - flows: 接続関係
   - gateways: 分岐点（必要時）

2. **描画処理**（テンプレート固定）
   - スイムレーン描画
   - タスク配置
   - フロー矢印
   - 実行とURL生成

## 🔍 AIが認識するキーワード

### アクター認識
- 部/課/チーム: 「営業部」「経理課」「開発チーム」
- 役職: 「部長」「課長」「担当者」
- 部門名のみ: 「営業」「経理」「人事」

### フロー認識
- 順序: 「→」「その後」「次に」「してから」
- 分岐: 「場合は」「なら」「のとき」
- 並列: 「同時に」「並行して」「一緒に」
- 承認: 「承認」「確認」「チェック」「判断」

### 条件認識
- 金額: 「○万円以上/以下/未満」
- 可否: 「OK/NG」「承認/却下」「あり/なし」
- その他: 「正常/異常」「成功/失敗」

## 🔧 カスタマイズ

生成されたコードの`CONFIG`セクションを編集することで：
- 色の変更
- サイズ調整
- レイアウト変更

が可能です。

## 📝 注意事項

1. **Google Slidesの制限** - API変更により一部メソッドが使えない場合があります
2. **複雑なフロー** - 非常に複雑な業務フローは手動調整が必要な場合があります
3. **日本語対応** - 日本語は問題なく使用できます

---

**まじん式リスペクト** 🙏

このプロンプトは「まじん式プロンプト」の革新的なアプローチにインスパイアされた非公式派生版です。